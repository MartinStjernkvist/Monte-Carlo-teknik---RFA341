import numpy as np
import pandas as pd
def Närmast(lista,tal):
        lista=np.array(lista)
        närmsta_index=(np.abs(lista-tal)).argmin()
        return lista[närmsta_index], närmsta_index

def Elektron_riktning(Elektron_energi): #Energi i elektron i tabell är i eV
    R=np.random.random() #Slumpmässig tal mellan 0-1
    
    #Läser in excel filen och tar ut koloumn med energi och scatter power
    file_scatter=pd.read_excel(r'../MC Linnea/Monte Carlo Linnea/Monte Carlo, test.xlsx')
    Energi_data=file_scatter['E(eV)'].to_list()
    Scatterpower_list=file_scatter['Scatter power Water'].to_list() #T/rho för vatten

    #Hittar närmast energi som liknar elektron energin och ta fram scatter power:
    rho=0.998 #densitet på vatten i g/cm^3

    #Tar index för närmaste energi på elektronen
    _,index=Närmast(Energi_data,Elektron_energi) 
    #Hitta ett sätt att få scattering power och därmed theata_s
    theata_s=Scatterpower_list[index]*rho 


    """
    Energi_data=np.array(Energi_data)
    differens=np.abs(Energi_data-Elektron_energi)
    närmast_energi=np.arg
    """
    return np.sqrt(-theata_s*np.log(1-R))